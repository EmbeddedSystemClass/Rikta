#include <FreeRTOS.h>
#include <FreeRTOSConfig.h>
#include <task.h>

#include <SEPS525_OLED.h>
#include <Pin.h>
#include <SPI.h>
#include "hw_includes.h"

#include "displaydemo.h"
#include "SerialDebugLogger.h"
#include "SEP525_DMA_FreeRTOS.h"

#define	BLACK   0x0000
#define	BLUE    0x001F
#define	RED     0xF800
#define	GREEN   0x07E0
#define CYAN    0x07FF
#define MAGENTA 0xF81F
#define YELLOW  0xFFE0
#define WHITE   0xFFFF


void DisplayDemo::vDisplayDemoThreadFunc(void *pvParameters)
{
    auto d = SEP525_DMA_FreeRTOS::instance();

    d->begin();

    DisplayDemo demo(d);

    int counter = 0;
    unsigned long time;

    while(1) {
        time = demo.playDemo(/*counter*/12);
        serialDebugWrite("Test #%d: took %d\n\r", counter++, time);
        //vTaskDelay(100);
    }
}

//////// DEMOS ////////////////

unsigned long DisplayDemo::testFillScreen() {
    unsigned long start = micros();
    display->fillScreen(BLACK);
    display->fillScreen(RED);
    display->fillScreen(GREEN);
    display->fillScreen(BLUE);
    display->fillScreen(BLACK);
    return micros() - start;
}

unsigned long DisplayDemo::testText() {
    display->fillScreen(BLACK);
    unsigned long start = micros();
    display->setCursor(0, 0);
    display->setTextColor(WHITE);  display->setTextSize(1);
    display->println("Hello World!");
    display->setTextColor(YELLOW); display->setTextSize(2);
    display->println(1234.56);
    display->setTextColor(RED);    display->setTextSize(3);
    display->println(0xDEADBEEF, HEX);
    display->setTextColor(GREEN);
    display->setTextSize(5);
    display->println("Groop");
    return micros() - start;
}

unsigned long DisplayDemo::testLines(uint16_t color) {
    unsigned long start, t;
    int           x1, y1, x2, y2,
            w = display->width(),
            h = display->height();

    display->fillScreen(BLACK);

    x1 = y1 = 0;
    y2    = h - 1;
    start = micros();
    for(x2=0; x2<w; x2+=6) display->drawLine(x1, y1, x2, y2, color);
    x2    = w - 1;
    for(y2=0; y2<h; y2+=6) display->drawLine(x1, y1, x2, y2, color);
    t     = micros() - start; // fillScreen doesn't count against timing

    display->fillScreen(BLACK);

    x1    = w - 1;
    y1    = 0;
    y2    = h - 1;
    start = micros();
    for(x2=0; x2<w; x2+=6) display->drawLine(x1, y1, x2, y2, color);
    x2    = 0;
    for(y2=0; y2<h; y2+=6) display->drawLine(x1, y1, x2, y2, color);
    t    += micros() - start;

    display->fillScreen(BLACK);

    x1    = 0;
    y1    = h - 1;
    y2    = 0;
    start = micros();
    for(x2=0; x2<w; x2+=6) display->drawLine(x1, y1, x2, y2, color);
    x2    = w - 1;
    for(y2=0; y2<h; y2+=6) display->drawLine(x1, y1, x2, y2, color);
    t    += micros() - start;

    display->fillScreen(BLACK);

    x1    = w - 1;
    y1    = h - 1;
    y2    = 0;
    start = micros();
    for(x2=0; x2<w; x2+=6) display->drawLine(x1, y1, x2, y2, color);
    x2    = 0;
    for(y2=0; y2<h; y2+=6) display->drawLine(x1, y1, x2, y2, color);

    return micros() - start;
}

unsigned long DisplayDemo::testFastLines(uint16_t color1, uint16_t color2) {
    unsigned long start;
    int           x, y, w = display->width(), h = display->height();

    display->fillScreen(BLACK);
    start = micros();
    for(y=0; y<h; y+=5) display->drawFastHLine(0, y, w, color1);
    for(x=0; x<w; x+=5) display->drawFastVLine(x, 0, h, color2);

    return micros() - start;
}

unsigned long DisplayDemo::testRects(uint16_t color) {
    unsigned long start;
    int           n, i, i2,
            cx = display->width()  / 2,
            cy = display->height() / 2;

    display->fillScreen(BLACK);
    n     = min(display->width(), display->height());
    start = micros();
    for(i=2; i<n; i+=6) {
        i2 = i / 2;
        display->drawRect(cx-i2, cy-i2, i, i, color);
    }

    return micros() - start;
}

unsigned long DisplayDemo::testFilledRects(uint16_t color1, uint16_t color2) {
    unsigned long start, t = 0;
    int           n, i, i2,
            cx = display->width()  / 2 - 1,
            cy = display->height() / 2 - 1;

    display->fillScreen(BLACK);
    n = min(display->width(), display->height());
    for(i=n; i>0; i-=6) {
        i2    = i / 2;
        start = micros();
        display->fillRect(cx-i2, cy-i2, i, i, color1);
        t    += micros() - start;
        // Outlines are not included in timing results
        display->drawRect(cx-i2, cy-i2, i, i, color2);
    }

    return t;
}

unsigned long DisplayDemo::testFilledCircles(uint8_t radius, uint16_t color) {
    unsigned long start;
    int x, y, w = display->width(), h = display->height(), r2 = radius * 2;

    display->fillScreen(BLACK);
    start = micros();
    for(x=radius; x<w; x+=r2) {
        for(y=radius; y<h; y+=r2) {
            display->fillCircle(x, y, radius, color);
        }
    }

    return micros() - start;
}

unsigned long DisplayDemo::testCircles(uint8_t radius, uint16_t color) {
    unsigned long start;
    int           x, y, r2 = radius * 2,
            w = display->width()  + radius,
            h = display->height() + radius;

    // Screen is not cleared for this one -- this is
    // intentional and does not affect the reported time.
    start = micros();
    for(x=0; x<w; x+=r2) {
        for(y=0; y<h; y+=r2) {
            display->drawCircle(x, y, radius, color);
        }
    }

    return micros() - start;
}

unsigned long DisplayDemo::testTriangles() {
    unsigned long start;
    int           n, i, cx = display->width()  / 2 - 1,
            cy = display->height() / 2 - 1;

    display->fillScreen(BLACK);
    n     = min(cx, cy);
    start = micros();
    for(i=0; i<n; i+=5) {
        display->drawTriangle(
                    cx    , cy - i, // peak
                    cx - i, cy + i, // bottom left
                    cx + i, cy + i, // bottom right
                    SEPS525_OLED::color565(0, 0, i));
    }

    return micros() - start;
}

unsigned long DisplayDemo::testFilledTriangles() {
    unsigned long start, t = 0;
    int           i, cx = display->width()  / 2 - 1,
            cy = display->height() / 2 - 1;

    display->fillScreen(BLACK);
    start = micros();
    for(i=min(cx,cy); i>10; i-=5) {
        start = micros();
        display->fillTriangle(cx, cy - i, cx - i, cy + i, cx + i, cy + i,
                              SEPS525_OLED::color565(0, i, i));
        t += micros() - start;
        display->drawTriangle(cx, cy - i, cx - i, cy + i, cx + i, cy + i,
                              SEPS525_OLED::color565(i, i, 0));
    }

    return t;
}

unsigned long DisplayDemo::testRoundRects() {
    unsigned long start;
    int           w, i, i2,
            cx = display->width()  / 2 - 1,
            cy = display->height() / 2 - 1;

    display->fillScreen(BLACK);
    w     = min(display->width(), display->height());
    start = micros();
    for(i=0; i<w; i+=6) {
        i2 = i / 2;
        display->drawRoundRect(cx-i2, cy-i2, i, i, i/8, SEPS525_OLED::color565(i, 0, 0));
    }

    return micros() - start;
}

unsigned long DisplayDemo::testFilledRoundRects() {
    unsigned long start;
    int           i, i2,
            cx = display->width()  / 2 - 1,
            cy = display->height() / 2 - 1;

    display->fillScreen(BLACK);
    start = micros();
    for(i=min(display->width(), display->height()); i>20; i-=6) {
        i2 = i / 2;
        display->fillRoundRect(cx-i2, cy-i2, i, i, i/8, SEPS525_OLED::color565(0, i, 0));
    }

    return micros() - start;
}

//////////////////////////////////////////
static const struct {
  unsigned int 	 width;
  unsigned int 	 height;
  unsigned int 	 bytes_per_pixel; /* 2:RGB16, 3:RGB, 4:RGBA */
  unsigned char	 pixel_data[64 * 64 * 2 + 1];
} test = {
  64, 64, 2,
  "-\071xj\377\212\235\202\272qYi\332y|\222\331yS\070\026I\336\212\233y{y\277\222"
  "~\212\234y?\233\037\254_\243wi\011\020\012\020\020\070<\212\237\243\226PwX\177\274"
  "\376\274\321\070R@\230X\222\070{\233\332\212\273\212\375\264<\223\272\201y"
  "\201\067h\025Px\202\373\305:\234\371\202\270zviurt\224\063s\221Q\017\204\266"
  "\275\266\265\266\265\266\265\326\275\367\275\030\306Y\316\232\326\373\336"
  "n\060l(\065Q~\202\\z\031aU@\067a\372\211\265P\022\060\273q\274y\372h\\y>\212<q"
  "|y\237\243\237\243}\232\214(\004\000\015(\333y>\243vP\330`\277\304\035\244N(\021"
  "\070\025@P\040\333\274}\336\275\233\034\223\371\201\371\211\366h\023HtPx\244\331"
  "\244\330z\227z\225i\224a\323\213\262\203\321QNI\256{\064\245\064\245\064\245"
  "\064\245U\255u\265\266\275\030\306y\316\272\326\014(\256\070\317\070wY\034z\272"
  "q\225H\021\040\025Q\027i\021\060\225H\234y\371h\372p\235\201}\202Zq\374\201\177"
  "\243\337\242\024a\002\000\010\040zq\275\232vP\231q\237\304\333\212\014\030\017\060\022"
  "\060o(\233\264|\336\233\233\271y\370\201wq\023H\022\070uz\367\244\367z\066r\365"
  "i\323X\223r\362\203Qb.AMAms\323\234\323\234\323\234\363\234\024\245\064\245"
  "u\255\327\275\070\306\232\326Vr\034\234~\244\335\223^\213\335\202\272q\063\070"
  "\015\010P(\022\060\021\060\033qZq\\\244\237\254\177\244\337\254\035\223}\212\377"
  "\242\273\211\007\030\004\010\026a\035\212uP:\202\037\264\270q\011\030\015\060\021@p\070"
  "\233\274\233\326Y\223\366huq\222X\020\060\322P\265\213\365z\025j\064j\363XRY"
  "R{\361joI-A-ALk\262\224\262\224\262\224\262\224\323\234\024\245U\255\266\265"
  "\030\306y\316\036\275\337\254\377\254\037\255\237\244\037\224\237\223}\202\365"
  "@\013\000\014\010\016\030wP\\y\275\254\177\275\177\254\337\254\237\244\335\222~"
  "\232?\232o@\002\000r@:q\226P\274\222\237\253\365X\010\020\013\040\016\060sa[\305\272"
  "\275\370\233\064qr`\017\070/\070sr\324r\224Y\364aRa\321P\222jQs\360Y\015A-AMA"
  "Lk\262\224\262\224\262\224\262\224\323\234\024\245U\255\266\265\030\306y\316"
  "\336\233\277\223\377\233\037\234?\234\377\223\277\213\237\223\037\233\272i"
  "-\030\011\000\017\040\033i\237\254_\254\237\233\277\233\177\223\037\223\\\212_\232"
  "\326`\002\000\015(XX\367`\335\232\235\222O\070\007\020\007\010\016(\271\222\272\315\271"
  "\254W\234\323q\020H\016\060\060Q\364r\224YsYsaqP\322a\062sqboQ.ANA\216Imk\323"
  "\234\322\234\322\234\323\234\024\245\064\245u\255\327\275\070\306\232\326\375"
  "\212\237\223?\244\037\234\237\223\177\223?\213\036\213\376\212\277\232\235"
  "\201\060(\007\000\365H\377\264\277\254?\202\337\212\237\223\337\212]\202\035\232"
  "\372x\005\020\010\030\026H\067i\337\232\230y\010\040\003\000\005\010uX\333\232Z\275\031\244"
  "\067\234Sr\016\060N\070Sj\024b\063QSYqP\362X\263r\263r\261Y\020IPIoQnI\216s\064\245"
  "\064\245\064\245\064\245U\255u\265\266\275\030\306y\316\272\326\234r\235z\377"
  "\212\337\233\037\244_\223\276\212\276\212\336\212}\212=\222}\211\021(\255\040"
  "\236\254\377\264\376\201\275y?\213\377\212~\202<\222\373x\011\030\003\000\022\070"
  "Zq\277\242\315@\001\000\256i\227\232yhy\212z\275\271\223\027\234Tr\015\040PQ\065"
  "r\064Y\063Y\222XrPTj\365z\364i\021Q\061QqYPQOI\357\203\266\265\266\265\266\265"
  "\266\265\326\275\367\275\030\306Y\316\232\326\373\336^\203\036{\276z]z\376"
  "\212\177\233\377\212~\202~\212]\212<\212\333\201\372p\222\070\373\233\037\265"
  "\236\212\233p\375\201\276\202\376y\274\201\271h\014\030\001\010\016\060\233y\374"
  "\201k(\362\202\036\345\235\253VP\327\212\232\305\071\223\330\243\260Y,\060\064"
  "r\225i\324XsX\022P\265i\027{vr\063a\362XrYrYQQPQP\214\070\306\070\306\070\306\070"
  "\306\070\316Y\316y\326\272\326\373\336\034\347\035\203\336z\376z\336\202\374"
  "q\374q~\212\276\212]\212=\202\374\201\273\201YqT@\033\203\237\254\337\212"
  "\273p\233h\375y\336\212^\233yy\016\040\000\010,\060|\201\070i\327y\337\334_\315"
  "\035\254UPX\223[\305:\233\026\223l@QY\027z\265`tX\021H\025a\371\212\231\202vi"
  "\322XSasa\062YRYqQ\221\224\232\326\232\326\272\326\272\326\272\326\332\336"
  "\373\336\373\346<\347\\\357Zr\337\233~\213\376\202\236z\334i\032azi<\212}"
  "\222\034\212\273y\232y\224H\366a\377\253\237\212\\y\031P}\212\037\326\377\315"
  "\277\264Wr!\000*\060\374xTP\371\222\237\325\177\315\\\222\022@\032\244\\\274\033"
  "\243\022r\257H\030z\326h\024X\022HtXz\212\333\222\270y\323`\363`\064a\023Y\022Y"
  "\022Y\360P\323\234\373\346\373\336\373\346\373\346\034\347\034\347<\347<\357"
  "]\357}\357\035\265\177\305\177\305\277\254\237\223\276z\333q\371X\330XZi\373"
  "\201\034\212\272\201\266Xp\070\334\222\237\232}y\030P{\202_\336?\305\377\264"
  "~\254\211I\012H\231XO(\034\254?\357\277\304VP\217\070\234\274\275\253\032\222"
  "\361Xuq\030q\024P\022@TP\032\212{\222xysXRX\224X\223X\364`\265i\365i\064j\064\255"
  "\\\357]\357\\\357]\357\\\357]\357]\357}\357}\357\235\367^\275?\275\277\315"
  "\277\315\037\275_\244\236\223<z\331`\025@\064\070\367`z\201Xy\016(\063I\177\232"
  "\335\201\071X\\\233\377\325\277\274\337\274\337\243\223\202JH\063\070\320\070"
  "\277\325\237\346\375\221\017(Ui\336\314\376\242\327psX\327h\024H\020(\022@\071"
  "\201\\\222\273\201\270y\367y\031\202\371y\030zYzyz\270\202Vz\064\255\235\367"
  "}\367\235\367}\357}\367}\357}\367\235\367\236\367\236\367\376\223\177\244"
  "\037\265\377\264\037\275\377\264_\244\377\233\036\223zy\065H\020\030Q\060\027q\263"
  "X\012\020\032y\336\200\033q\177\305\337\315\237\264\037\305\277\253\227zk\060\016"
  "\040tr\237\356_\253\025H\020\060=\232\377\303[\221\023H\022@\020\070\017(\023@:y\236"
  "\232\376\222>\223\277\243\276\253\276\253}\264\234\264{\254\031\213viuiT\255"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367>\234^\213\377\233\237\254\377\264\237\254?\244\037\244\277\233_\233"
  "\336\222\070a\017\030\014\020\060\070\011\030.\070\035\200\335\232\377\346_\305?\264"
  "\337\274?\264\233\212l(L\040Z\254?\325\372h\020\040W`\237\262\035\252\022@M(L"
  "\060\022@:q\276\232\237\253\177\243\037\233\037\233?\243\337\263\276\304\035\305"
  "\274\274\273\264\071\244\327q\226iT\255\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\376\315\277\254\277\223\177"
  "\223\337\233\037\244\037\244\337\233\237\233?\223\377\222\277\232\375\211\223"
  "@\012\010\006\000&\020\027`\177\253\377\346?\305\277\253?\264\337\253\276\232\254"
  "H\216@\277\304\276\274\222@\017\060\274\210\337\241PHF\040\220i[\211\236\231"
  "_\242~\232{\211\033\201\375\221\336\242\377\263_\274\376\263\275\253\374\253"
  "\233\264\371\233\070z\026rT\255\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\276\325?\326\277\305_\244_\213\377\202"
  "_\223\277\233\277\233\177\233\337\222\236\222\277\222\037\222\230X\014\030\001"
  "\000\012(\236\263\177\326\037\305_\243\177\253_\243\236\222\315X\323X\177\304"
  "z\223+\030\022@_\200qP\002\010q`\235\210\234\200\330p\067`\030h\071x\\\211\336\242"
  "?\253_\253\036\233^\233\235\243\234\243\032\244\331\212wq\364hT\255\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\022{\236\325?\326\377\305_\265\377\233\037\213\276\202\336\212\177\233_\233"
  "\336\222}\212]\222\236\221[h\014\040\001\000\267\202\377\335\177\264_\212\377\232"
  "\037\233=\222\220P\067i?\253\357\070\010\020v`\377\242\230\233\223q\026P\023P\022"
  "H\025P\027`\032p\234\210\376\231\236\232~\232\237\232\376\232\335\232\374\232"
  "<\223Xy\025h\023`s`T\255\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367@\010\313I\032\234\277\254\277\254_\244\037\244"
  "_\223\236\202~\212~\212]\212}\212]\212\333\211\034\221zp\011\040lQ\377\324?"
  "\264\235\201\235\201\237\232\335\211sH\332x\324X\004\000\015(:\212\277\315\377"
  "\304^\253n\070\015\060\023H\025P\027`\031h\031p:x\273\200|\221\275\221\234\221\374"
  "\221\334\232\334\243\031\233\365p\025i\365yT\255\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\000\000D\010\063I]z?\213\037"
  "\213\276\202\336\212\336\212^\202\375\201\274\201\233y\273y\333\201\272\211"
  "\071\201\063Xm@\276\253\337\253\\\201\032p\334\200\234\200\027X\063P\003\010\003\010"
  "qH\336\273\237\274\277\222\235\232\256@\010\030\014(\017(\022@\025P\026X\027`\030"
  "h\031x[\210\234\221|\232\274\232\034\233\273\264y\223\325h\324hT\255\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\363r\032\265]\275>\275?\275\377\264\377\233\036\223}\212\035\202\275y<q\332"
  "p\067`\267`\027i\265h\021X+(y\212\337\252\232h\025P\026P\030`\025P\005\020\000\000\005\040"
  "w\201\337\314\237\233?\232\035\232m\070\012(\023P\066`\271x\272\200\232x\272x"
  "\232x\272\200\334\231]\232\275\242\374\242\233\222Z\233Y\244\225y\264`T\255"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367>\336\337\315\337\315\377\315\337\305\177\305?\275\237\264\337\243"
  "_\233\337\212\035\202{yyh\026P\023@\020@\012\070\003\010\061Y\237\241\027P\020\060\022"
  "\070\022\060\011\030b(A\040\014\060\337\252_\274]\211\177\221\274\211\061H\025X\032"
  "\200;\200\373\210\234\221\375\221\276\232_\243}\232\334\221\375\221\275\242"
  "\035\264<\254[\254\271\254\227\202\265qT\255\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\336\264\337\264?\275?\275"
  "\037\265\277\264\237\264_\254\037\244\277\233_\233\377\222]\212{qx`\023@\015"
  "\060\006\040\000\000F\030\036\221\027P\010\020\010\010\231yX\212ePi`\372h?\274<\232\032x"
  "\234\210\222P\015\060\025`\030pZx\033\201\235\222\177\243?\243}\232\234\221\274"
  "\221\034\232|\211<\222\034\305;\275\271\212\367yVzT\255\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\276\264\337"
  "\264\337\264\277\264\177\254_\254\377\243\277\233\277\233\237\233_\233\377"
  "\222\177\222\375\201[\201\232p\023H\007\030!\000\203\040U`:`\004\000\000\000\263\212_\355"
  "\307\060\011\040?\232^\253\227h\026`\027htX\223P\064P\026Xzx\035\232\177\232|\211"
  "Z\200:\210<\221\035\232\374\231\034\232\034\264\373\253\231\211Wy\266y\265q"
  "T\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\336\305\277\305?\275\237\254?\254?\244\037\244\237\233?\223\037"
  "\223\337\222\177\222>\212\375\211\375\211\274\211\334\210\027`M\070\014z\312"
  "@\031P\012\030\000\000v\254~\345f\020\017(\177\242\031\212\017\060\022H\225hz\211\035\222"
  ";\202Zy\272xyx\027`\025X\030p{\220\275\231\035\232\237\252\234\242tq\063X\024`"
  "\063`\022X\062XT\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\276\305\337\305\237\305\377\264\177\254\377\243"
  "\277\233_\233\337\212~\202~\212\236\212^\212=\212\034\212z\201xp\027`\023P\314"
  "H\202\030\011\040*\070b\030\332\253Uz\001\020\221X\236\211\356@\011\040U`\232\201\\"
  "\222\\\222\336\232_\243\337\232\272yR@\023H\027`\071p\373\210\234\231\374\231"
  "\270p\024P\065`vh\326h\025qUiT\255\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\235\367>\316?\265\377\264\177\254\277\233\337"
  "\202\037\202\336y\275y\235y\275y|y|y\274y:qV`\021@\014(\007\030\000\000\000\000\040\010e"
  "H\262p\376\252\357Y\040\030)q\264`\005\010\003\020\331x\277\231\177\242\037\253\335"
  "\242\234\232\337\253\377\274\373\222\066`yp\332x\231x\030h\027`\031pz\200:\211"
  "\231\201\331\201\070\202\066zT\255\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\036\265\177\265\177\244\177\223\377"
  "\212\377\212?\223\277\233\377\253\377\253\277\253\377\242\376\211[yX`\022"
  "\070\013\040\007\020\002\000\000\000\000\000\000\000\002\020\027X\377\262:\275\202\040\201\070)ik@\007"
  "\020&\030h(\257@\024a\322`\252H\370\212\237\305\377\315<\232\233\200\034\222"
  "\333\211;\201Zx\232\200\032\201Y\201\271\201\270y\226y\326qT\255\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\031Y"
  "{z\035\213\234\202<z{z{\202\272\202\330z\227rtjSb\325a\371hY`\064H\062@\022@"
  "\020\070\013\040\002\000\000\000\000\000\012\020\275\232\335\314\204\030\001\000\203\060i@\016\070"
  "\015\060\014(\016\060\022H\024X\020H\224q\376\264\277\357\035\305X`;\201^\243~\243"
  "\333\221:\211\332\211\031\212\071\212\367\201vq\063iT\255\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367Xa\367X\027Y\325"
  "P\223HQ\070.(\014\040\007\010\003\000\006\010\214\060SQ\034z\036\222}\211|x\030`\016\060\004\010"
  "\000\000\000\000\000\000\003\010\332\212\026\213G\060\356X.\070\015\070\017@\022H\027`\031p\271x"
  "Z\201<\211\032y~\305\377\377:\233\026X\031p;\201\036\254>\254:\211y\211Z\222"
  "y\222\230\212\067\202\263qT\255\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\265H\022\060\020\040\016\030\014\020\013\010\012"
  "\020\010\000*\020\265Y=\223~\243\377\232\275\211\333x\070`\020(\010\010\004\010\"\010"
  ")(\016\070\004\020\040\010\065\202\257ifa\060\212\067`\033p\071p\071p\232x:\201\233\211"
  "z\201{\211\234\221\273\253z\233u`\024X\026h\030p|\211=\233\331\200\230\200\231"
  "\201\030\212X\212V\202\065zT\255\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\017\040/\040\061(\061(\060(\017\040\016\030TQ"
  "\336\243\037\254\037\223=\202\033y\030h\025Ht@UYy\202\235\222?\231\071p\012(\000\000"
  "\000\010\256X\214@\013@T`MH\067`\\x\273\200\034\211\274\221=\222^\232\331\211\262"
  "X\021@UX\331\221\365h\024X\026h\030pY\200\071\201\231\211\271\211\330\201\027\202"
  "\066\202\065zT\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367Zr\033r\274i[iz`\030P\374\201\037\275\237\254\377\212"
  "\335y\333x\031X\031a\033\223\237\264\337\304\337\263\036\222zp\015(\000\000\001\000\000"
  "\010\003\030\007(\062@\\\201\014Y\012(\031h;\200\334\210\335\231^\232\037\253\\\243"
  "\360P\062H\333\211\335\242\227h\026`\030p\030x\030x\371\200\271\211\071\222\271"
  "\222\270\212\226\202U\202T\255\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367~\223\376\202\036\202\275\201\272p{q_"
  "\265\277\254?\223\337\222\375\211:`\232i_\275\237\315\377\274\377\253\376"
  "\221:x\025P\016(\014\040\011\030\006\020\000\020\012(\026H\235\211\230y\015\060\024P\031p\233"
  "\200\234\221\036\242\377\252\034\233Uy\267p\373\211\366x\025p\030p\030p\031p\030"
  "p\030p\230xX\201\370\201X\212\227\212V\213T\255\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\035\203\376\212\376\222"
  "}\222{\201\376\243_\265\177\254\277\223\337\222\034yYX\276\264\377\315_\254"
  "\337\243\377\232\235\211:p\030`\030X\024\070\023\070\020\070\001\010\007\060\030`>\222["
  "\233OP\024X\030hZx\034\211\235\221>\232\372\211\366h\233\201\333\211Sh\021`\025"
  "h\026h\030p\031xYx\230pwp\227pVyw\202\366\202T\255\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367~\223\235\212\234\211"
  "\270`\330X\277\264\337\305\277\305\037\234\036\202Zh\373p_\275\237\305\277"
  "\264\037\233\376\201<y\034\201\\\200\032p\232p~\200\015\060\000\010\004(\066`_\242\234"
  "\253\352@\015\070\027`\027hZ\200\234\221\276\242}\232\035\222}\232\273\211\230"
  "x\024h\023`\024`\026`\027h\070p\271\200x\201\330\201\030\202w\202\326\202T\255\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\034\202zqy`\026@\270X\177\305\277\336\037\265\337\212\376\201\374p\333"
  "p\237\254\277\264\037\223>\212\375\201\036\212>\212\375\211\035\212\235\211"
  "rX\005\020\000\030\004\060TP?\232_\253\017Y\002\040\022P\030h\027pZp\373\200\275\221\272"
  "\211\263p\022`\031x<\210\030x\030p\030p\027h\027h\030x\230x\230\201\367\201\067\202"
  "\226\202T\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\272qZi\032i\070PxX\336\315_\275\377\212\037\223\377\222"
  "]y:p\235\222\277\243\376\222\276\222\377\222\376\222?\223\276\222\033yTX\016"
  "@\011(\000\020\002\040\022@\235\221\337\273z\222\004\060\006\060\027`;xzx\273\200^\221:"
  "\201\016H\016H\024`\031x\\\220[\210\032\200\032\200\232\200\371\200\330x\327x\067"
  "y\266y\365qT\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367|\202\334y\273yyXXq=\254\237\223\037\234\237\244\377"
  "\222\034y\275\201\277\222?\233\237\243\037\244?\244\037\244\337\222<\201:x\031"
  "h\025P\005\020\000\010\001\010\021@\276\210\336\263\337\273\217P\000\040-H\031`{\200\\\211"
  "\035\222\037\253\332\211\020@\020H\023X\027p[\210\273\210;\211:\201y\211\271\211"
  "\270\211\030\202W\202UzT\255\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\235\202\374\201\372p\027P\272q]\223\177\244"
  "\277\254\277\223\377\222\276\212\036\254\237\315\277\274?\254_\264\237\264"
  "\277\243\237\222~\222\177\231\035\200\011(\000\000\007\040\001\000\012\060\276\210\376\242"
  "?\315\070\202\005(\012@\026`\234\200\034\211\375\221\376\242\337\263yy\021H\022X"
  "\024X\026h\071x\232\200\272\200\031\201\370\200\067y\367\201w\202\226\202T\255"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\373yx`yX|\202?\264?\254\377\274_\275?\244\336\233\371h\031q\177\305"
  "\337\315?\305\277\274_\264\377\253\237\233\377\232\234\221\017@\002\020\007\040"
  "\014\060\001\000f\070}\231\037\222?\315~\304\211\060\007\070[\200zpyp]\221>\232\277\253"
  "\277\263\271x\025`\026h\026p\027h\027h\030p\030x\067p\026pVp\066quqT\255\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\027a"
  "\070i^\264\377\315\277\325_\315\177\264\037\244\275\222Zpzh\033q~\212\276\243"
  "_\264\237\264?\254_\233\037\233\271y-\070\011\040\013(\016\070\017@\003\020\204\060\370"
  "\221\377\231~\274\277\335\020Q\010\060\234\210\031`\027`\\\210\335\221\376\242"
  "_\274\337\232Zx\031\200\032\200\071\200Xx\030p\030h\027h\027p\026puhUqT\255\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\024Y\275\264?\336\337\325\277\315_\254~\212\334p\\h}y?\233\177\243\234\201"
  ":p\372x\235\212\376\222\236\222\233\211\021H\017\070\020@\015\060\023H\023P\007\040"
  "\004\030\263\201\337\262\276\232\377\314\270\212\017\070\374\210{\200\030p;\200"
  "]\211\375\221?\253\237\264~\222[\200\233\200\273\210\333\210\032\211\331\200"
  "wp\066h\026hUh\223`T\255\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\270z_\336_\336\237\305~\223]q\334p\335\201\177"
  "\233\177\254\237\233\375\201\235\201\034q]\212\036\223\337\222\276\222\270"
  "h\026X\026`\022H\020\070\027`\025`\013\060\010\040\360X\177\273>\232}\211|\232rP:\201"
  "~\221\031p\234\210\376\221\\\201\231x}\232\034\222Z\200\233\200<\211[\211{"
  "\221\033\222\372\221x\201\327pu`\063XT\255\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\\\254\237\336_\254^z\275"
  "q^\202\237\243\037\265\337\264\376\222\036\202>\202\\q\275\212_\254?\233\037"
  "\233\374\201X`\272pXh\024H\025P\233\200Uh\016\070\014(\216\070\236\273\337\263"
  "\335x\275\200SX\227y\377\262:\200\273\210\177\232>\222Wh\026pZ\210\232\220"
  "\373\220|\221\274\211\374\211\373\211;\222\232\222\231\212\327q\064aT\255"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\035\254~\223\375y\276\212_\244?\275\337\264\337\233\037\213\277\212"
  "~\212\331`;\202\337\264\337\243\237\243\277\222\332h\372p{y\231h\026P\271"
  "h]\221Vh\022H\022@O\070{\253\177\304\276\211_\211\267h\066q\277\273\034\211Z\200"
  "^\222\337\232\032\201\026pZ\210\234\241\234\241<\231|\221\274\211\033\212;\212"
  ":\202\231\212\030\213\226\202T\255\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\372y\036\223\037\244\337\264\037\265"
  "\277\254?\244\337\233_\223\374\201WP\372q?\275\337\243\277\243\337\243\334"
  "y\272h\234\201;yxh\272p^\222>\222wh\025P\025P\022\070\272\222\337\304\377\232"
  "?\222\371x\027q?\264~\232|\221\276\232\277\232\336\211z\200\031\200\\\231\275"
  "\252\334\241\234\231\034\232\033\212[\212\232\212\071\202Wz\326\202T\255\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367>\244\177\254_\244\177\244\276\233\236\233\236\233}\212\372p\030P:i\037"
  "\275\177\254\237\233?\244\376\212\033i\274y\334\201;q[q\374\201\236\232\236"
  "\232\230p\027`\027`\024H\033\212\177\315\037\264\177\232;\201\267p?\264\177\253"
  ">\222\177\243\336\232\036\212\036\222\273\220\333\220}\242\376\252\274\231"
  "\034\232\374\232[\212\032\202y\202Xz\066rT\255\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\036\265\336\233\276\202\374"
  "y\334y\035\202\274y\033iy`Y`\276\233\037\265\037\244_\254\377\243|y<y]\212\334"
  "\201\334y]\212\033\202\337\232\236\232\332xyp\071p\030`\273\211\237\315\237"
  "\264\377\232\334\221Wx^\243?\264^\222\177\243\277\253>\222~\222\276\222\274"
  "\221\234\221\276\242>\253\374\231[\232\034\233\032\202\030z\230zvrT\255\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\035\213\034z\034z~\202\277\212~\212\335y[q:`\374y\337\254\237\254_\254"
  "\336\274\236\212\333p=\212=\212\375\201~\212;\202Z\212\237\253^\222\372\200"
  "\333\200\272x\031h:\201?\264?\244\177\254\235\232\030\200]\232?\264\337\232"
  "?\243\037\264_\243~\222\377\222\276\222\375\231\375\231>\253\236\263\034\232"
  "\333\232\032\223\030\202Wz\226zT\255\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\\\202\374y\236\212\377\212\276\202"
  "\236\212}\202\033qzh^\223\237\254\237\254_\275\377\243\034q\035\202\336\212"
  "\035\202^\202\376\222\331q]\233\337\253^\222\373\200;\211\033\201Zp\232x\276"
  "\221\335\221\035\243\034\232y\220\233\221\337\253_\243?\243\037\264?\264?\233"
  "\237\222\377\232\276\232\036\232=\232\236\263\235\253;\222:\233\331\222\027"
  "zVrT\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367=\223\236\223\377\233?\254?\254\237\223\275\212;\202\033\202"
  "\337\233\177\244_\275\177\275\036z\335y\037\223\276\212\236\212\037\223\272"
  "\212\070z_\264\177\243=\222|\201\334\211|\211\272x\231p\275\211}\221\373\210"
  "Y\200\071\221\373\241\336\242\237\243_\243\337\263\036\264\336\222\337\232"
  "\037\233_\233\037\243~\232\336\242\375\263\\\243Z\212\031\223w\202VzT\255\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\230\202|\233\177\264<\244\323jyr\336\222\334\222\234\212~\223\337\264"
  "\377\305\177\223\275q\376\212\037\223\276\212\337\212\336\243\070z\334\243"
  "\177\264\177\243\035\222\274\211\035\222\335\211[\201xp\275\211_\232\275\221"
  "\\\221\334\231}\242]\232\037\233\277\253\237\274\034\243wp~\222_\233?\233\337"
  "\243\177\243\235\242\035\243<\254\032\233\271\212\230\212VzT\255\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\374"
  "\232\272\202LAB\010\012\061\374\212_\233\274\212\371y=\223\377\315\037\275\035"
  "z\236\202_\223?\223\276\212\237\233\032\213Wz\377\304\037\254\237\243\335\211"
  "\335\211\035\222\375\221\375\221\272\200;\201\177\232\036\232\036\222\036\232"
  "}\242\276\252~\232\177\253\237\274>\243xx\231x~\222_\233\277\243\377\253"
  ">\243\275\232|\243\333\243Y\223\370\212v\202T\255\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\021Z\203\020\000\000\256"
  "I\336\253\377\243\035\223[\212vi\\\223\337\315^\223~\202\177\223\237\223\376"
  "\212_\223\036\254\024Y\272\223?\305\037\254\237\243\335\221\375\221=\222=\222"
  "\276\242:\211\332x\237\232\237\232>\232\376\221~\242\376\262\037\253\037\243"
  "\277\253\177\274\235\232Y\200\232\210^\222\277\243\377\253>\254]\233\334"
  "\232\333\253\031\244\230\223\266\202T\255\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\000\000\001\000\021Z\337\253\277"
  "\243^\223|\212\071zVay\202\177\264\037\223^\223\177\223?\223\277\233\237\264"
  "\266a\264H?\275\177\254\177\254_\243\335\221^\232^\222\236\232?\243{\211"
  "Yx>\222\377\242\277\232\177\232\177\232_\263\237\253_\243\337\263\277\304"
  "?\264\334\221\332\210z\200^\222\277\243>\254}\254|\233\233\243\371\243\030"
  "\244\026\213T\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367!\000\062b\377\263\337\233~\233\235\222:\202\370q\330"
  "qVa{\202\237\233~\223\337\233\237\254\236\254\367i\021(Yz\177\305\177\254"
  "\337\264?\233>\222\276\232~\222\037\233_\243\275\221\070p;\201?\243\037\243"
  "\377\232\337\232\177\263\337\273\277\253\237\253?\274\037\305\375\242\034\211"
  "\033\221\273\210\235\222~\233\035\244\034\234\233\243\271\243\030\244\326\233"
  "T\255\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236"
  "\367\236\367\224j\037\264\377\243\277\233\336\232\\\212\031z\031r\071z\263H\061"
  "\060wa_\233~\233\234\222\367`\023\060\024@\234\223?\275\177\254\337\264\377\232"
  "\237\222\037\233\236\232\337\253\237\253\035\222\032\201\371x\336\232_\243_"
  "\243?\243_\243\037\274_\274\337\253\037\274\377\304\037\264\235\221\274\231"
  "\034\221\374\221\236\233\035\223|\223;\213y\233\030\244\366\233T\255\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "~\274\337\233\377\233^\233|\212\032\202\032\202Zzva\063@\021\060\026a\337\232\273"
  "\201\332x\067X\024@VP\036\244\277\264\177\254\377\274\037\233\337\232?\233\376"
  "\232_\264\377\263^\232[\211\372\200\035\222_\243?\243_\243?\243\377\263\337"
  "\304\177\274\037\264\337\304\337\304\336\242\274\221\335\221\235\221~\243"
  "}\254\\\223\232zYz\030\244\366\233T\255\236\367\236\367\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\376\233\377\233\337\243\275"
  "\222\372y[\202\273\212\267iT@T@\264H\335\222~\222\333\211\373\211\330`\024"
  "@\030a_\244\277\254\337\264\377\274\337\222\377\232_\233?\233\277\274\037\254"
  "~\232\274\221[\211\\\211\236\232\237\243_\243_\233\277\253\337\304\337\304"
  "?\264\237\274\377\304\236\253=\222\375\221\275\221\235\232\235\264<\254["
  "\223\031\213x\223V\213T\255\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367\376\233\037\244\036\233\332\201\032\202\274"
  "\222\030r\223H\367`\224H\330i?\233]\212\034\212\273\201WP\025H\272q_\244\177"
  "\254\037\275\177\264\277\222?\233\237\243\237\243\277\274\037\254\337\232\035"
  "\222\375\221\274\211|\211>\243\277\243\177\243\237\243\237\274\337\304_\274"
  "\337\304\337\304~\253\336\242>\232\375\231\035\222\275\243\234\254\273\233"
  "\271\233\230\223v\203T\255\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\236\367\236\367\236\367>\244\236\233\332y\372y\374\222Z\202\364"
  "P\270q\067a\224H\375\212\336\222]\212}\222\232\201wXw`\332y\037\244\177\254"
  "\177\305_\254\377\222_\233\237\243\377\253\377\274?\254?\243]\222]\222}\222"
  "|\211\\\211_\233\337\243\337\243\037\254\337\304\277\304\277\274?\305\275"
  "\253>\243\337\242>\232=\232\275\222\\\244;\234\231\223\230\223V\213T\255"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\236\367\336\243\373\201yy\035\223\334\222\026Y\270q|\212\224H\227a\177\223"
  "\236\212}\222]\222zy\327`\367p\372y\337\233\277\264\277\315\037\254_\233\237"
  "\243\377\243\177\264_\305_\264\237\243\236\232\236\222\336\232=\222\373\200"
  "]\222_\243\177\243\377\243\237\274?\315\237\274\237\325\236\253\275\232\337"
  "\263\276\242\236\232\235\222\234\233;\234\271\223x\223\066\213T\255\236\367"
  "\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367"
  "\033\202Xq\034\223]\223xi\331q\036\223WY\024Y\334\212_\223\276\222\336\222]\222"
  "yy\030i\070q\332y\237\223\277\264\237\315\337\243_\233\037\254\237\254\377\274"
  "?\305_\264\377\253\277\232\276\232\377\232~\232[\211=\243?\264\277\222\237"
  "\233\337\243\237\274\237\325\377\335\336\242\335\211\237\274\177\253\236"
  "\232\335\232\034\223\233\223\271\223x\223\066\213T\255\236\367\236\367\236"
  "\367\236\367\236\367\236\367\236\367\236\367\236\367\236\367",
};
///////////////////

unsigned long DisplayDemo::testdrawBMP() {
    display->fillScreen(BLACK);
    unsigned int start = micros();

    display->drawImage((const uint16_t*)test.pixel_data, 20, 20, test.width, test.width);

    return micros() - start;
}

/////////////////////////////////////////////

unsigned long DisplayDemo::playDemo(int demo)
{
    demo %= demo_count;
    switch (demo) {
    case 0:
        return testFillScreen();
    case 1:
        return testText();
    case 2:
        return testLines(CYAN);
    case 3:
        return testFastLines(RED, BLUE);
    case 4:
        return testRects(GREEN);
    case 5:
        return testFilledRects(YELLOW, MAGENTA);
    case 6:
        return testFilledCircles(10, MAGENTA);
    case 7:
        return testCircles(10, WHITE);
    case 8:
        return testTriangles();
    case 9:
        return testFilledTriangles();
    case 10:
        return testRoundRects();
    case 11:
        return testFilledRoundRects();
    case 12:
        return testdrawBMP();
    default:
        return 0;
    }
}
